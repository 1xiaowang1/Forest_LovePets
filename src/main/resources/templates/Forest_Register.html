<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>FOREST-爱心宠物系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description"/>
    <meta content="Coderthemes" name="author"/>
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.4.0/sweetalert2.min.css "/>
    <!-- App css -->
    <link href="assets/css/icons.min1.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/app.min1.css" rel="stylesheet" type="text/css"/>
    <script src="js/username.js"></script>

    <style type="text/css">
        .mmm {
            font-size: 10px;
            color: red;
        }
    </style>
    <script src="js/jquery-3.5.1.min.js"></script>
</head>

<body class="authentication-bg">

<div class="account-pages mt-5 mb-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-5">
                <div class="card">
                    <!-- Logo-->
                    <div class="card-header pt-4 pb-4 text-center bg-primary">
                        <a href="index.html">
                            <span><img src="assets/images/logo.png" alt="" height="18"></span>
                        </a>
                    </div>
                    <div class="card-body p-4">

                        <div class="text-center w-75 m-auto">
                            <h4 class="text-dark-50 text-center mt-0 font-weight-bold">免费注册</h4>
                            <p class="text-muted mb-4">没有账户？创建你的账户， </p>
                        </div>
                        <div class="form-group">
                            <label for="forest_User_LoginName">登录昵称: <span id="Forest_1"></span></label>
                            <input class="form-control" type="text" id="forest_User_LoginName" placeholder="请输入用户名" required>
                        </div>

                        <div class="form-group">
                            <label for="forest_User_Password">用户密码:<span id="Forest_2"></span></label>
                            <input class="form-control" type="password" id="forest_User_Password" required
                                   placeholder="请输入密码">
                        </div>
                        <div class="form-group">
                            <label for="forest_User_Password_1">确认密码:<span id="Forest_3"></span></label>
                            <input class="form-control" type="password" id="forest_User_Password_1" required
                                   placeholder="请再次输入密码">
                        </div>
                        <div class="form-group">
                            <label for="forest_User_Name">用户姓名:<span id="Forest_4"></span></label>
                            <input class="form-control" type="text" required id="forest_User_Name" placeholder="请输入用户姓名">
                        </div>
                        <div class="form-group">
                            <label for="forest_User_Card">身份证号:<span id="Forest_5"></span></label>
                            <input class="form-control" type="text" required id="forest_User_Card" placeholder="请输入身份证号">
                        </div>
                        <div class="form-group">
                            <label for="forest_User_Sex">性别: <span id="Forest_6"></span></label>
                            <select class="form-control" required id="forest_User_Sex">
                                <option value="男">男</option>
                                <option value="女">女</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="forest_User_Phone">手机号:<span id="Forest_8"></span></label>
                            <input class="form-control" type="text" required id="forest_User_Phone" placeholder="请输入手机号">
                        </div>
                        <div class="form-group" id="email">
                            <label for="forest_User_Email">电子邮件:<span id="Forest_7"></span></label>
                            <input class="form-control" type="text" required id="forest_User_Email" placeholder="请输入电子邮件">
                        </div>
                        <div class="form-group" id="code">
                            <label for="forest_User_Email">验证码:</label>
                            <input class="form-control" type="text" required id="forest_User_Code" placeholder="请输入验证码">
                        </div>
                        <div class="form-group">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="checkbox-signup">
                                <label class="custom-control-label" for="checkbox-signup">我接受 <a
                                        href="pages-register-Termsandconditions.html"
                                        class="text-muted">条款和条件</a></label>
                            </div>
                        </div>

                        <div class="form-group mb-0 text-center">
                            <button class="btn btn-primary" type="submit" id="button">注册</button>
                        </div>
                    </div> <!-- end card-body -->
                </div>
                <!-- end card -->

                <div class="row mt-3">
                    <div class="col-12 text-center">
                        <p class="text-muted">已经有帐号了? <a href="Forest_Login.html" class="text-muted ml-1"><b>登录</b></a>
                        </p>
                    </div> <!-- end col-->
                </div>
                <!-- end row -->

            </div> <!-- end col -->
        </div>
        <!-- end row -->
    </div>
    <!-- end container -->
</div>
<!-- end page -->

<footer class="footer footer-alt">
    <input type="hidden" id="emailNum"/>
    2020 - 2021 © Forest - Coderthemes.com
</footer>

<!-- App js -->
<script src="assets/js/app.min.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.4.0/sweetalert2.min.js "></script>


</body>

<script type="text/javascript">
    var imgObjTrue = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //账号验证
    var flas = false; //标识符
    $("#forest_User_LoginName").blur(function () {
        //取出账号值
        var name = $("#forest_User_LoginName").val();
        //    账号必须为字母+数字的组合，不能出现特殊字符
        var varreg = /^(?=.*[a-zA-Z]+)(?=.*[0-9]+)[a-zA-Z0-9]+$/;
        //alert(varreg.test(name))
        if (name == null || name == "") {
            $("#Forest_1").empty();
            var Forest_1 = $("<span class='mmm'>登录账号不能为空,请重新输入</span>");
            $("#Forest_1").append(imgObjFalse);
            $("#Forest_1").append(Forest_1);
            $("#forest_User_LoginName").val("");
            flas = false;
        } else if (!varreg.test(name)) {
            $("#Forest_1").empty();
            var Forest_1 = $("<span class='mmm'>必须是字母+数字不能出现特殊字符</span>");
            $("#Forest_1").append(imgObjFalse);
            $("#Forest_1").append(Forest_1);
            $("#forest_User_LoginName").val("");
            flas = false;
        } else {
            $("#Forest_1").empty();
            $("#Forest_1").append(imgObjTrue);
            findUserName()
            flas = true;
            return;
        }
    });
    var imgObjTrue1 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse1 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //密码验证
    var flas1 = false;
    $("#forest_User_Password").blur(function () {
        var pass = $("#forest_User_Password").val(); //
        //密码规则为字母+数字的组合，不得出现特殊字符
        var patrm1 = /^[a-z0-9]{6,10}$/;
        if (pass == null || pass == "") {
            $("#Forest_2").empty();
            var Forest_2 = $("<span class='mmm'>登录密码不能为空,请重新输入</span>");
            $("#Forest_2").append(imgObjFalse1);
            $("#Forest_2").append(Forest_2);
            $("#forest_User_Password").val("");
            flas1 = false;
        } else if (!patrm1.test(pass)) {
            $("#Forest_2").empty();
            var Forest_2 = $("<span class='mmm'>小写字母+数字，不得出现特殊字符，长度为6-10</span>");
            $("#Forest_2").append(imgObjFalse1);
            $("#Forest_2").append(Forest_2);
            $("#forest_User_Password").val("");
            flas1 = false;
        } else {
            $("#Forest_2").empty();
            $("#Forest_2").append(imgObjTrue1);
            flas1 = true;
            return;
        }

    });

    var imgObjTrue2 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse2 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //重复密码验证
    var flas2 = false;
    $("#forest_User_Password_1").blur(function () {
        var pass2 = $("#forest_User_Password_1").val(); //
        var pass1 = $("#forest_User_Password").val();

        if (pass2 == null || pass2 == "") {
            $("#Forest_3").empty();
            var Forest_3 = $("<span class='mmm'>密码验证不能为空,请重新输入</span>");
            $("#Forest_3").append(imgObjFalse2);
            $("#Forest_3").append(Forest_3);
            $("#forest_User_Password_1").val("");
            flas2 = false;
        } else if (pass2 != pass1) {
            $("#Forest_3").empty();
            var Forest_3 = $("<span class='mmm'>两次密码输入不一致，请重新输入</span>");
            $("#Forest_3").append(imgObjFalse2);
            $("#Forest_3").append(Forest_3);
            $("#forest_User_Password_1").val("");
            flas2 = false;
        } else {
            $("#Forest_3").empty();
            $("#Forest_3").append(imgObjTrue2);
            flas2 = true;
            return;
        }

    });
    var imgObjTrue3 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse3 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //用户姓名验证
    var flas3 = false;
    $("#forest_User_Name").blur(function () {
        var nc = $("#forest_User_Name").val(); //
        var pattern = /^[\u4E00-\u9FA5]{2,6}$/;
        if (nc == null || nc == "") {
            $("#Forest_4").empty();
            var Forest_4 = $("<span class='mmm'>用户姓名输入不能为空，请重新输入</span>");
            $("#Forest_4").append(imgObjFalse3);
            $("#Forest_4").append(Forest_4);
            $("#forest_User_Name").val("");
            flas3 = false;
        } else if (!pattern.test(nc)) {
            $("#Forest_4").empty();
            var Forest_4 = $("<span class='mmm'>请输入中文名称</span>");
            $("#Forest_4").append(imgObjFalse3);
            $("#Forest_4").append(Forest_4);
            $("#forest_User_Name").val("");
            flas3 = false;
        } else {
            $("#Forest_4").empty();
            $("#Forest_4").append(imgObjTrue3);
            flas3 = true;
            return;
        }


    });

    //身份证验证
    var imgObjTrue4 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse4 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    var flas4 = false;
    $("#forest_User_Card").blur(function () {
        var sfz = $("#forest_User_Card").val(); //
        //判断是身份证正则表达式
        var aa = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;

        if (sfz == null || sfz == "") {
            $("#Forest_5").empty();
            var Forest_5 = $("<span class='mmm'>身份证号输入不能为空，请重新输入</span>");
            $("#Forest_5").append(imgObjFalse4);
            $("#Forest_5").append(Forest_5);
            $("#forest_User_Card").val("");
            flas4 = false;

        } else if (!aa.test(sfz) || sfz.length != 18) {
            $("#Forest_5").empty();
            var Forest_5 = $("<span class='mmm'>身份证号输入有误，请重新输入</span>");
            $("#Forest_5").append(imgObjFalse4);
            $("#Forest_5").append(Forest_5);
            $("#forest_User_Card").val("");
            flas4 = false;
        } else {
            $("#Forest_5").empty();
            $("#Forest_5").append(imgObjTrue4);
            findUsrCredit();
            flas4 = true;
            return;
        }

    });

    var imgObjTrue5 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse5 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //性别验证
    var flas5 = false;
    $("#forest_User_Sex").blur(function () {
        var sex = $("#forest_User_Sex").val(); //
        if (sex == null || sex == "") {
            $("#Forest_6").empty();
            $("#Forest_6").append(imgObjFalse5);
            flas5 = false;
        } else {
            $("#Forest_6").empty();
            $("#Forest_6").append(imgObjTrue5);
            flas5 = true;
            return;
        }
    });

    var imgObjTrue6 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse6 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //邮箱验证
    var flas6 = false;
    $("#forest_User_Email").blur(function () {
        var emil = $("#forest_User_Email").val();
        //邮箱的正则表单达式
        var aa = /^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;
        if (emil == null || emil == "") {
            $("#Forest_7").empty();
            var Forest_7 = $("<span class='mmm'>邮箱账号输入不能为空，请重新输入</span>");
            $("#Forest_7").append(imgObjFalse6);
            $("#Forest_7").append(Forest_7);
            $("#forest_User_Email").val("");
            flas6 = false;
        } else if (!aa.test(emil)) {
            $("#Forest_7").empty();
            var Forest_7 = $("<span class='mmm'>邮箱要验证是否带有@，必须以.com结尾</span>");
            $("#Forest_7").append(imgObjFalse6);
            $("#Forest_7").append(Forest_7);
            $("#forest_User_Email").val("");
            flas6 = false;
        } else {
            $("#Forest_7").empty();
            $("#Forest_7").append(imgObjTrue6);
            flas6 = true;
            return;
        }

    });

    var imgObjTrue7 = $("<img src='assets/true.jpg' height=\"22\" width=\"23\">");
    var imgObjFalse7 = $("<img src='assets/false.jpg' height=\"22\" width=\"23\">");
    //手机号验证
    var flas7 = false;
    $("#forest_User_Phone").blur(function () {
        var tell1 = $("#forest_User_Phone").val(); //
        //以1开头的正则表达式
        var aa = /^1\d{10}$/

        if (tell1 == null || tell1 == "") {
            $("#Forest_8").empty();
            var Forest_8 = $("<span class='mmm'>手机号输入不能为空，请重新输入</span>");
            $("#Forest_8").append(imgObjFalse7);
            $("#Forest_8").append(Forest_8);
            $("#forest_User_Phone").val("");
            flas7 = false;
        } else if (!aa.test(tell1) || tell1.length != 11) {
            $("#Forest_8").empty();
            var Forest_8 = $("<span class='mmm'>必须是纯数字11位1开头</span>");
            $("#Forest_8").append(imgObjFalse7);
            $("#Forest_8").append(Forest_8);
            $("#forest_User_Phone").val("");
            flas7 = false;
        } else {
            $("#Forest_8").empty();
            $("#Forest_8").append(imgObjTrue7);
            flas7 = true;
            return;
        }

    });


    //注册
    function register() {
        var forest_User_LoginName = $("#forest_User_LoginName").val();  //登录昵称
        var forest_User_Password = $("#forest_User_Password").val();  //用户密码
        var forest_User_Password_1 = $("#forest_User_Password_1").val();//再次输入密码
        var forest_User_Name = $("#forest_User_Name").val();          //用户姓名
        var forest_User_Card = $("#forest_User_Card").val();        //身份证号
        var forest_User_Sex = $("#forest_User_Sex").val();        //用户性别
        var forest_User_Email = $("#forest_User_Email").val();    //电子邮件
        var forest_User_Phone = $("#forest_User_Phone").val();    //手机号
        var emailNum=$("#emailNum").val();//系统验证码
        var forest_User_Code=$("#forest_User_Code").val();//手动验证码
        swal.fire({
            type: 'warning', // 弹框类型
            title: '确认', //标题
            text: "请确认是否注册此信息", //显示内容
            confirmButtonColor: '#3085d6',// 确定按钮的 颜色
            confirmButtonText: '确定',// 确定按钮的 文字
            showCancelButton: true, // 是否显示取消按钮
            cancelButtonColor: '#d33', // 取消按钮的 颜色
            cancelButtonText: "取消", // 取消按钮的 文字
            focusCancel: true, // 是否聚焦 取消按钮
            reverseButtons: true  // 是否 反转 两个按钮的位置 默认是  左边 确定  右边 取消
        }).then(function (isConfirm) {
            if (isConfirm.value) {
                if ($("#checkbox-signup").is(":checked")) {
                    if (flas == true && flas1 == true && flas2 == true && flas3 == true && flas4 == true  && flas7 == true) {
                        var data = {
                            "forest_User_LoginName": forest_User_LoginName,
                            "forest_User_Password": forest_User_Password,
                            "forest_User_Name": forest_User_Name,
                            "forest_User_Card": forest_User_Card,
                            "forest_User_Sex": forest_User_Sex,
                            "forest_User_Email": forest_User_Email,
                            "forest_User_Phone": forest_User_Phone,
                            "emailNum":emailNum,
                            "forest_User_Code":forest_User_Code
                        };
                        $.ajax({
                            url: "register",
                            type: "POST",
                            dataType: "json",
                            contentType: 'application/json;charset=utf-8',
                            data: JSON.stringify(data),
                            async: false,
                            success: function (data) {
                                if (data.code == 200) {
                                    window.location.href=userUrl+"/Forest_Login.html";
                                } else if(data.code=500)
                                {
                                    Swal.fire("提示", "请输入完整数据", "question");
                                }else {
                                    Swal.fire("提示", "请输入完整正确验证码", "error");
                                }
                            }
                        });
                    } else {
                        Swal.fire("提示", "输入数据有误", "question");
                    }
                } else {
                    Swal.fire("提示", "请接收服务条款", "warning");
                }
            } else {
                Swal.fire("提示", "已取消提交", "error");
            }
        })


    }
    //获取系统用户登录名
    function findUserName() {
        var forest_User_LoginName = $("#forest_User_LoginName").val();  //登录昵称
        var data = {
            "forest_User_LoginName": forest_User_LoginName
        };
        $.ajax({
            url: "ForestUserEntityIfExitLogin",
            type: "POST",
            dataType: "json",
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(data),
            async: false,
            success: function (data) {
                if (data.code == 200) {
                } else {
                    Swal.fire("提示", "已存在该用户名", "warning");
                    $("#forest_User_LoginName").val("");
                    $("#Forest_1").empty();
                    var Forest_1 = $("<span class='mmm'>必须是字母+数字不能出现特殊字符</span>");
                    $("#Forest_1").append(imgObjFalse);
                    $("#Forest_1").append(Forest_1);
                }
            }
        });
    }
    //获取系统用户的身份证
    function findUsrCredit() {
        var forest_User_Card = $("#forest_User_Card").val();        //身份证号
        var data = {
            "forest_User_Card": forest_User_Card
        };
        $.ajax({
            url: "ForestUserEntityIfExitCard",
            type: "POST",
            dataType: "json",
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(data),
            async: false,
            success: function (data) {
                if (data.code == 200) {

                } else {
                    Swal.fire("提示", "已存在该用户", "warning");
                    $("#forest_User_Card").val("");
                    $("#Forest_4").empty();
                    var Forest_4 = $("<span class='mmm'>用户姓名输入不能为空，请重新输入</span>");
                    $("#Forest_4").append(imgObjFalse3);
                    $("#Forest_4").append(Forest_4);

                }
            }
        });
    }
    $("#forest_User_Email").blur(function () {
        var forest_User_Email = $("#forest_User_Email").val();
        var forest_User_Name=$("#forest_User_Name").val();
        alert(forest_User_Name)
        var data = {
            "name":forest_User_Name,
            "cc": forest_User_Email
        };
        $.ajax({
            url: "goEmail",
            type: "POST",
            dataType: "json",
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(data),
            success: function (data) {
                if (data.code == 200) {
                    $("#emailNum").val(data.emailNum);
                    $("#email").attr("style", "display:none;");//隐藏div
                    $("#code").attr("style", "display:block;");//显示div
                } else {
                    $("#code").attr("style", "display:none;");//隐藏div
                    $("#email").attr("style", "display:block;");//显示div
                }
            }
        });
    });

    $(function () {
        //点击注册
        $("#button").click(function () {
            register();
        });
        $("#code").attr("style", "display:none;");//隐藏div
        $("#email").attr("style", "display:block;");//显示div
    });
</script>

</html>
